<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Scott Graham" />

<meta name="date" content="2017-12-06" />

<title>STAT 541 Final Project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">STAT 541 Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../../">Home</a>
</li>
<li>
  <a href="Report.html">Report</a>
</li>
<li>
  <a href="Presentation.html">Presentation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">STAT 541 Final Project</h1>
<h4 class="author"><em>Scott Graham</em></h4>
<h4 class="date"><em>December 06, 2017</em></h4>

</div>


<p><span class="math display">\[
  \newcommand{\Prob}{\operatorname{P}}
  \newcommand{\E}{\operatorname{E}}
  \newcommand{\Var}{\operatorname{Var}}
  \newcommand{\Cov}{\operatorname{Cov}}
  \newcommand{\se}{\operatorname{se}}
  \newcommand{\re}{\operatorname{re}}
  \newcommand{\ybar}{{\overline{Y}}}
  \newcommand{\phat}{{\hat{p}}}
  \newcommand{\that}{{\hat{T}}}
  \newcommand{\med}{{\tilde{Y}}}
  \newcommand{\Logit}{{\operatorname{Logit}}}
  \]</span></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="data" class="section level2">
<h2>Data</h2>
<p>This data set contains the results of 217 games played in the video games NHL 12, 13, and 17, played between 2 friends, Tim and Randy (P1 and P2 respectively)<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. They compiled a incredibly detailed gamelog for each game played, with well over 50 variables recorded, and period by period breakdowns. For those not familiar, the NHL series of video games is developed by EA Sports, and serves as the most readily available means of simulating real NHL.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> While obviously not perfect, it serves as a decent proxy for predicting the results of hockey games in general, as many of the same principles apply.</p>
<p>Since the outcome of a game is determined by the end score, any variables referencing the goals scored have been removed, as they serve little to know interest in the prediction of games. However there is one exception, and that is who scored the first goal of the game, which in itself seemed to be an interesting possible predictor. Instead more periphery statistics will be looked at, such as hits, shots, face off percentage, breakaways, penalties, and other such things. As well, a 1 game lagged result term has been included, to see if any autocorrelation exists within the results, and if it plays a significant role in the prediction process.</p>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<p>In this report, a Binomial and Log Linear LASSO model will be used in the variable selection and coefficient estimation process, in addition to the usual step wise methods. As previously mentioned, the autocorrelation of the results will also be examined to see if such an effect exists. Finally a variety of visual tools will be used in the exploratory analysis portion of the paper, in an effort to understand the relationships within the data.</p>
<p>For the LASSO model, the package <code>glmnet</code> is used, to perform an elastic-net version of the LASSO model<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. All the data cleaning is done with the usage of a variety of packages from the “tidyverse”. This includes the packages <code>dplyr</code>, <code>tidyr</code>, <code>magrittr</code>, and <code>tibble</code>.<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> As well, the <code>flatr</code> package is used to transform contingency tables into “tidy” data frames, where each variable has its own column for each observation. <code>flatr</code> was created by myself in an effort to simplify some of the cleaning done for this course. Finally <code>ggplot2</code> is used as the primary visualization method, due to its flexibility in creating visualizations, and overall better appearance than base graphics.</p>
</div>
<div id="research-question" class="section level2">
<h2>Research Question</h2>
<p>What periphery (non-goal related) statistics can be used to predict the outcome of a hockey game?</p>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory Analysis</h1>
<div id="correlation-matrix" class="section level2">
<h2>Correlation Matrix</h2>
<p><img src="Presentation_files/figure-html/Cor%20Matrix-1.png" width="672" /></p>
</div>
<div id="distribution-of-goals" class="section level2">
<h2>Distribution of Goals</h2>
<p><img src="Presentation_files/figure-html/Goal%20Distribution-1.png" width="672" /></p>
</div>
<div id="goal-distribution-by-version" class="section level2">
<h2>Goal Distribution by Version</h2>
<p><img src="Presentation_files/figure-html/Goal%20Distribution%20by%20Version-1.png" width="672" /></p>
</div>
<div id="goals-vs.shots" class="section level2">
<h2>Goals vs. Shots</h2>
<blockquote>
<p>“You miss 100% of the shots you don’t take.” - Wayne Gretzky</p>
</blockquote>
<p><img src="Presentation_files/figure-html/GvS-1.png" width="672" /></p>
</div>
<div id="goals-vs.shots-results" class="section level2">
<h2>Goals vs. Shots Results</h2>
<ol style="list-style-type: decimal">
<li>P1 should shoot the puck more often, as his expected goals will rise at a faster rate than P2’s</li>
<li>P2 shouldn’t worry as much about getting lots of shots, but primarily focus on getting high danger chances (chances close to the net)</li>
</ol>
</div>
<div id="autocorrelation" class="section level2">
<h2>Autocorrelation</h2>
<p>Autocorrelation measures the correlation between <span class="math inline">\(\left(X_{t-k}, X_{t}\right), t=k, k+1\dots,n\)</span>. It is primarily used in timeseries analysis to measure the tendency for a time series to be mean reverting (negative autocorrelation) or a tendency to go on long runs in one direct or the other (positive autocorrelation). This is primarily used in the analysis of stock returns, but can be applied to any time series.</p>
</div>
<div id="autocorrelation-plot" class="section level2">
<h2>Autocorrelation Plot</h2>
<p><img src="Presentation_files/figure-html/Autocorrelation%20Plot-1.png" width="672" /></p>
</div>
<div id="autocorrelation-model" class="section level2">
<h2>Autocorrelation Model</h2>
<p><span class="math display">\[
  \operatorname{Logit}\left( \text{P1 Wins} \right) =
  \alpha + \beta_{1}\text{Previous Game&#39;s Result}
\]</span></p>
<pre><code>## 
## Call:
## glm(formula = `P1 Win` ~ `P1 Previous Game`, family = binomial, 
##     data = .)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.8677  -0.6905  -0.6905  -0.6905   1.7610  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            -1.3122     0.1904  -6.891 5.55e-12 ***
## `P1 Previous Game`Yes   0.5294     0.3568   1.484    0.138    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 236.11  on 215  degrees of freedom
## Residual deviance: 233.98  on 214  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: 237.98
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="durbin-watson-test" class="section level2">
<h2>Durbin-Watson Test</h2>
<p><span class="math display">\[
  H_{0}: \text{Autocorrelation} = 0
\]</span> <span class="math display">\[
  H_{1}: \text{Autocorrelation} \neq 0
\]</span></p>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  hockey_acf_logit
## DW = 2.024, p-value = 0.8647
## alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<div id="modeling" class="section level1">
<h1>Modeling</h1>
<div id="contingency-table-model" class="section level2">
<h2>Contingency Table Model</h2>
<pre><code>## , , Home = P1
## 
##           Winner
## Scored_1st P1 P2
##         P1 12 12
##         P2  4 23
## 
## , , Home = P2
## 
##           Winner
## Scored_1st P1 P2
##         P1 25 35
##         P2 10 96</code></pre>
</div>
<div id="flatten_ct" class="section level2">
<h2>flatten_ct</h2>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Scored_1st
</th>
<th style="text-align:left;">
Winner
</th>
<th style="text-align:left;">
Home
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Scored_1st
</th>
<th style="text-align:left;">
Winner
</th>
<th style="text-align:left;">
Home
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
25
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
96
</td>
</tr>
</tbody>
</table>
</div>
<div id="regression-models-and-goodness-of-fit-tests" class="section level2">
<h2>Regression Models and Goodness of Fit Tests</h2>
<div id="logit-model" class="section level3">
<h3>Logit Model</h3>
<p><span class="math display">\[
  \operatorname{Logit}\left( \text{P1 Wins} \right) =
  \alpha + \beta_{1}\text{Scored First} + \beta_{2}\text{Home Team}
\]</span></p>
</div>
<div id="log-linear-model" class="section level3">
<h3>Log Linear Model</h3>
<p><span class="math display">\[
  \ln(\mu) =
  \alpha + \beta_{1}\text{Scored First} + \beta_{2}\text{P1 Wins} + \beta_{3}\text{Home Team}
\]</span></p>
</div>
</div>
<div id="regression-models-and-goodness-of-fit-tests-outputs" class="section level2">
<h2>Regression Models and Goodness of Fit Tests Outputs</h2>
<pre><code>## 
## Call:
## glm(formula = Winner ~ Scored_1st + Home, family = binomial, 
##     data = .)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1606   0.4515   0.4515   0.5451   1.1967  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -0.0454     0.3525  -0.129    0.898    
## Scored_1stP2   1.8769     0.3591   5.227 1.72e-07 ***
## HomeP2         0.4006     0.3883   1.032    0.302    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 236.65  on 216  degrees of freedom
## Residual deviance: 203.72  on 214  degrees of freedom
## AIC: 209.72
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre><code>## 
## Chi-squared Goodness of Fit Test 
## 
## model: hockey_ct_logit 
## Chi-squared = 0.04855, df = 1, p-value = 0.82561</code></pre>
<pre><code>## 
## G-squared Goodness of Fit Test 
## 
## model: hockey_ct_logit 
## G-squared = 0.04815, df = 1, p-value = 0.82632</code></pre>
<pre><code>## 
## Call:
## glm(formula = n ~ (Scored_1st + Winner + Home)^2, family = poisson, 
##     data = .)
## 
## Deviance Residuals: 
##        1         2         3         4         5         6         7  
## -0.07803   0.05466   0.07922  -0.04591   0.13938  -0.08535  -0.05656  
##        8  
##  0.02782  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             2.5074     0.2671   9.387  &lt; 2e-16 ***
## Scored_1stP2           -1.1916     0.4036  -2.953  0.00315 ** 
## WinnerP2               -0.0454     0.3525  -0.129  0.89754    
## HomeP2                  0.7006     0.3150   2.224  0.02614 *  
## Scored_1stP2:WinnerP2   1.8769     0.3591   5.227 1.73e-07 ***
## Scored_1stP2:HomeP2     0.3131     0.3527   0.888  0.37472    
## WinnerP2:HomeP2         0.4006     0.3883   1.032  0.30227    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 174.425496  on 7  degrees of freedom
## Residual deviance:   0.048146  on 1  degrees of freedom
## AIC: 51.99
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<pre><code>## 
## Chi-squared Goodness of Fit Test 
## 
## model: hockey_ct_loglin 
## Chi-squared = 0.04855, df = 1, p-value = 0.82561</code></pre>
<pre><code>## 
## G-squared Goodness of Fit Test 
## 
## model: hockey_ct_loglin 
## G-squared = 0.04815, df = 1, p-value = 0.82632</code></pre>
</div>
<div id="full-model" class="section level2">
<h2>Full Model</h2>
<pre><code>##             (Intercept)          `Scored 1st`P2              `P1 Shots` 
##            -9.882439877            -1.964100240             0.013922296 
##              `P2 Shots`               `P1 Hits`               `P2 Hits` 
##            -0.016037708            -0.007771521             0.043845796 
##                `P1 ToA`                `P2 ToA`            `P1 Passing` 
##            -0.209459372            -0.052092628             8.197579923 
##            `P2 Passing`           `P1 Faceoffs`           `P2 Faceoffs` 
##             9.170534901            -0.061719701            -0.066995303 
## `P1 Offensive Faceoffs` `P2 Offensive Faceoffs`                 `P1 PM` 
##             0.072268107             0.071543085             0.050668097 
##                 `P2 PM`         `P1 Powerplays`         `P2 Powerplays` 
##             0.005239128             0.249659414            -0.066562314 
##      `P1 Penalty Shots`      `P2 Penalty Shots`         `P1 Breakaways` 
##             0.226441915            -1.324943617             0.227003485 
##         `P2 Breakaways` 
##            -0.041275380</code></pre>
<ul>
<li>Scored 1st is significant</li>
<li>P1, P2 Passing, and P1 Breakaways all have p-values <span class="math inline">\(&lt;0.10\)</span></li>
</ul>
</div>
<div id="total-model" class="section level2">
<h2>Total Model</h2>
<pre><code>## 
## Call:
## glm(formula = `P1 Win` ~ Shots + Hits + ToA + Passing + Faceoffs + 
##     `Offensive Faceoffs` + PM + Powerplays + `Penalty Shots` + 
##     Breakaways, family = binomial, data = hockey_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2274  -0.7810  -0.6014  -0.3266   2.0747  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)          -7.987e+00  3.537e+00  -2.258   0.0239 *
## Shots                 5.606e-05  1.720e-02   0.003   0.9974  
## Hits                  3.196e-02  2.088e-02   1.531   0.1259  
## ToA                  -1.102e-01  2.074e-01  -0.532   0.5950  
## Passing               6.133e+00  2.515e+00   2.439   0.0147 *
## Faceoffs             -5.143e-02  2.142e-02  -2.401   0.0163 *
## `Offensive Faceoffs`  7.981e-02  6.330e-02   1.261   0.2074  
## PM                   -1.882e-03  1.705e-02  -0.110   0.9121  
## Powerplays            8.546e-02  7.343e-02   1.164   0.2445  
## `Penalty Shots`      -3.159e-01  2.807e-01  -1.125   0.2605  
## Breakaways            6.545e-02  7.864e-02   0.832   0.4052  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 236.65  on 216  degrees of freedom
## Residual deviance: 221.64  on 206  degrees of freedom
## AIC: 243.64
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre><code>## 
## Chi-squared Goodness of Fit Test 
## 
## model: hockey_full_logit_03 
## Chi-squared = 209.3532, df = 206, p-value = 0.42187</code></pre>
</div>
<div id="backward-bic" class="section level2">
<h2>Backward BIC</h2>
<pre><code>## 
## Call:
## glm(formula = `P1 Win` ~ `Scored 1st` + `P1 Powerplays` + `P2 Penalty Shots`, 
##     family = binomial, data = hockey_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3816  -0.6402  -0.4301  -0.2053   2.7064  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -0.8114     0.3667  -2.213   0.0269 *  
## `Scored 1st`P2      -1.7359     0.3675  -4.723 2.32e-06 ***
## `P1 Powerplays`      0.2133     0.0900   2.370   0.0178 *  
## `P2 Penalty Shots`  -1.5155     0.7730  -1.961   0.0499 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 236.65  on 216  degrees of freedom
## Residual deviance: 193.78  on 213  degrees of freedom
## AIC: 201.78
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<pre><code>## 
## Chi-squared Goodness of Fit Test 
## 
## model: hockey_step_logit_01 
## Chi-squared = 29.64574, df = 213, p-value = 1</code></pre>
<pre><code>## 
## G-squared Goodness of Fit Test 
## 
## model: hockey_step_logit_01 
## G-squared = NA, df = 213, p-value = NA</code></pre>
</div>
<div id="backward-bic-model" class="section level2">
<h2>Backward BIC Model</h2>
<p><span class="math display">\[
  \operatorname{Logit}\left( \text{P1 Wins} \right) =
  \alpha + \beta_{1}\text{Scored 1st} + \beta_{2}\text{P1 Powerplays} 
\]</span> <span class="math display">\[
  + \beta_{3}\text{P2 Penalty Shots}
\]</span> <span class="math display">\[
  =
  -0.8114 - 1.7359\text{Scored 1st} + 0.2133\text{P1 Powerplays}
\]</span> <span class="math display">\[
  - 1.5155\text{P2 Penalty Shots}
\]</span> Where: <span class="math display">\[
  \text{Scored 1st} =
  \begin{cases}
    0,\text{ if P1} \\
    1,\text{ if P2}
  \end{cases}
\]</span></p>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                         2.5 %    97.5 %
## (Intercept)        0.21242841 0.9011030
## `Scored 1st`P2     0.08355758 0.3556937
## `P1 Powerplays`    1.04004592 1.4827889
## `P2 Penalty Shots` 0.03360702 0.8073160</code></pre>
</div>
<div id="forward-bic" class="section level2">
<h2>Forward BIC</h2>
<pre><code>## 
## Call:
## glm(formula = `P1 Win` ~ `Scored 1st` + `P1 Shots` + `P2 Shots` + 
##     `P1 Hits` + `P2 Hits` + `P1 ToA` + `P2 ToA` + `P1 Passing` + 
##     `P2 Passing` + `P1 Faceoffs` + `P2 Faceoffs` + `P1 Offensive Faceoffs` + 
##     `P2 Offensive Faceoffs` + `P1 PM` + `P2 PM` + `P1 Powerplays` + 
##     `P2 Powerplays` + `P1 Penalty Shots` + `P2 Penalty Shots` + 
##     `P1 Breakaways` + `P2 Breakaways`, family = binomial, data = hockey_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9680  -0.6815  -0.3479  -0.1289   2.5973  
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             -9.882440   4.551421  -2.171   0.0299 *  
## `Scored 1st`P2          -1.964100   0.445035  -4.413 1.02e-05 ***
## `P1 Shots`               0.013922   0.024908   0.559   0.5762    
## `P2 Shots`              -0.016038   0.029605  -0.542   0.5880    
## `P1 Hits`               -0.007772   0.041855  -0.186   0.8527    
## `P2 Hits`                0.043846   0.032562   1.347   0.1781    
## `P1 ToA`                -0.209459   0.313304  -0.669   0.5038    
## `P2 ToA`                -0.052093   0.306604  -0.170   0.8651    
## `P1 Passing`             8.197580   4.273661   1.918   0.0551 .  
## `P2 Passing`             9.170535   4.748918   1.931   0.0535 .  
## `P1 Faceoffs`           -0.061720   0.048063  -1.284   0.1991    
## `P2 Faceoffs`           -0.066995   0.057201  -1.171   0.2415    
## `P1 Offensive Faceoffs`  0.072268   0.100372   0.720   0.4715    
## `P2 Offensive Faceoffs`  0.071543   0.101292   0.706   0.4800    
## `P1 PM`                  0.050668   0.087914   0.576   0.5644    
## `P2 PM`                  0.005239   0.086114   0.061   0.9515    
## `P1 Powerplays`          0.249659   0.211105   1.183   0.2370    
## `P2 Powerplays`         -0.066562   0.217815  -0.306   0.7599    
## `P1 Penalty Shots`       0.226442   0.418251   0.541   0.5882    
## `P2 Penalty Shots`      -1.324944   0.805789  -1.644   0.1001    
## `P1 Breakaways`          0.227003   0.129030   1.759   0.0785 .  
## `P2 Breakaways`         -0.041275   0.147986  -0.279   0.7803    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 236.65  on 216  degrees of freedom
## Residual deviance: 175.63  on 195  degrees of freedom
## AIC: 219.63
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Note this is the second full model discussed earlier. Since stepwise selection is almost never used in favour of other methods, and the fact that it gave us some not so useful results, LASSO will be looked at as well in hopes of a better model<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>.</p>
</div>
</div>
<div id="lasso" class="section level1">
<h1>LASSO</h1>
<div id="lasso-01-variables" class="section level2">
<h2>LASSO 01 Variables</h2>
<pre><code>##  [1] &quot;Scored 1st Boolean (P2)&quot; &quot;P1 Shots&quot;               
##  [3] &quot;P2 Shots&quot;                &quot;P1 Hits&quot;                
##  [5] &quot;P2 Hits&quot;                 &quot;P1 ToA&quot;                 
##  [7] &quot;P2 ToA&quot;                  &quot;P1 Passing&quot;             
##  [9] &quot;P2 Passing&quot;              &quot;P1 PM&quot;                  
## [11] &quot;P2 PM&quot;                   &quot;P1 Powerplays&quot;          
## [13] &quot;P2 Powerplays&quot;           &quot;P1 Faceoffs&quot;            
## [15] &quot;P2 Faceoffs&quot;             &quot;P1 Breakaways&quot;          
## [17] &quot;P2 Breakaways&quot;           &quot;P1 Penalty Shots&quot;       
## [19] &quot;P2 Penalty Shots&quot;        &quot;P1 Offensive Faceoffs&quot;  
## [21] &quot;P2 Offensive Faceoffs&quot;</code></pre>
</div>
<div id="lasso-01-plot" class="section level2">
<h2>LASSO 01 Plot</h2>
<p><img src="Presentation_files/figure-html/LASSO%2001%20Plot-1.png" width="672" /></p>
</div>
<div id="lasso-01-coefficients-1se" class="section level2">
<h2>LASSO 01 Coefficients 1se</h2>
<pre><code>## 22 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                  1
## (Intercept)             -0.8527071
## Scored 1st Boolean (P2) -0.5670376
## P1 Shots                 .        
## P2 Shots                 .        
## P1 Hits                  .        
## P2 Hits                  .        
## P1 ToA                   .        
## P2 ToA                   .        
## P1 Passing               .        
## P2 Passing               .        
## P1 PM                    .        
## P2 PM                    .        
## P1 Powerplays            .        
## P2 Powerplays            .        
## P1 Faceoffs              .        
## P2 Faceoffs              .        
## P1 Breakaways            .        
## P2 Breakaways            .        
## P1 Penalty Shots         .        
## P2 Penalty Shots         .        
## P1 Offensive Faceoffs    .        
## P2 Offensive Faceoffs    .</code></pre>
</div>
<div id="lasso-01-coefficients-min" class="section level2">
<h2>LASSO 01 Coefficients Min</h2>
<pre><code>## 22 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                    1
## (Intercept)             -2.103339281
## Scored 1st Boolean (P2) -1.398137226
## P1 Shots                 0.004405199
## P2 Shots                 .          
## P1 Hits                  .          
## P2 Hits                  .          
## P1 ToA                   .          
## P2 ToA                   .          
## P1 Passing               0.903758203
## P2 Passing               0.990987539
## P1 PM                    .          
## P2 PM                    .          
## P1 Powerplays            0.116633884
## P2 Powerplays            .          
## P1 Faceoffs              .          
## P2 Faceoffs              .          
## P1 Breakaways            0.056989459
## P2 Breakaways            .          
## P1 Penalty Shots         .          
## P2 Penalty Shots        -0.497227038
## P1 Offensive Faceoffs    .          
## P2 Offensive Faceoffs    .</code></pre>
</div>
<div id="lasso-01-average-coefficient" class="section level2">
<h2>LASSO 01 Average Coefficient</h2>
<pre><code>##             (Intercept) Scored 1st Boolean (P2)                P1 Shots 
##           -2.343864e+00           -1.413696e+00            4.576515e-03 
##                P2 Shots                 P1 Hits                 P2 Hits 
##           -2.228331e-05            0.000000e+00            0.000000e+00 
##                  P1 ToA                  P2 ToA              P1 Passing 
##            0.000000e+00            0.000000e+00            1.073199e+00 
##              P2 Passing                   P1 PM                   P2 PM 
##            1.215923e+00            0.000000e+00            5.687496e-05 
##           P1 Powerplays           P2 Powerplays             P1 Faceoffs 
##            1.217150e-01            0.000000e+00           -1.352674e-04 
##             P2 Faceoffs           P1 Breakaways           P2 Breakaways 
##            0.000000e+00            6.276038e-02            0.000000e+00 
##        P1 Penalty Shots        P2 Penalty Shots   P1 Offensive Faceoffs 
##            0.000000e+00           -5.293945e-01            2.589165e-05 
##   P2 Offensive Faceoffs 
##            0.000000e+00</code></pre>
</div>
<div id="lasso-01-average-lambda" class="section level2">
<h2>LASSO 01 Average Lambda</h2>
<pre><code>## 22 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                    1
## (Intercept)             -2.291872149
## Scored 1st Boolean (P2) -1.411379910
## P1 Shots                 0.004591247
## P2 Shots                 .          
## P1 Hits                  .          
## P2 Hits                  .          
## P1 ToA                   .          
## P2 ToA                   .          
## P1 Passing               1.033854992
## P2 Passing               1.158818635
## P1 PM                    .          
## P2 PM                    .          
## P1 Powerplays            0.121235931
## P2 Powerplays            .          
## P1 Faceoffs              .          
## P2 Faceoffs              .          
## P1 Breakaways            0.062261956
## P2 Breakaways            .          
## P1 Penalty Shots         .          
## P2 Penalty Shots        -0.525402691
## P1 Offensive Faceoffs    .          
## P2 Offensive Faceoffs    .</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p><a href="#fnref3">↩</a></p></li>
<li id="fn4"><p><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p><a href="http://andrewgelman.com/2014/06/02/hate-stepwise-regression/" class="uri">http://andrewgelman.com/2014/06/02/hate-stepwise-regression/</a><a href="#fnref5">↩</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
