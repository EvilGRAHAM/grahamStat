c(
sum(sex_ct[,,"W"])
,sum(sex_ct[,,"B"])
)
)
)
,Gender =
as.factor(
rep(
rep(c("M", "F"), times = dim(sex_ct)[3])
,times =
c(
sum(sex_ct["M",,"W"])
,sum(sex_ct["F",,"W"])
,sum(sex_ct["M",,"B"])
,sum(sex_ct["F",,"B"])
)
)
)
,Intercourse =
as.numeric(
rep(
rep(c(1, 0), times = dim(sex_ct)[3]*dim(sex_ct)[1])
,times =
c(
sum(sex_ct["M","Y","W"])
,sum(sex_ct["M","N","W"])
,sum(sex_ct["F","Y","W"])
,sum(sex_ct["F","N","W"])
,sum(sex_ct["M","Y","B"])
,sum(sex_ct["M","N","B"])
,sum(sex_ct["F","Y","B"])
,sum(sex_ct["F","N","B"])
)
)
)
)
sex_ct <-
array(
data =
c(
43, 26, 134, 149
,29, 22, 23, 36
)
,dim = c(2, 2, 2)
,dimnames = list(
Gender = c("M", "F")
,Intercourse = c("Y", "N")
,Race = c("W", "B")
)
)
sex_ct
sex_ct_flip <-
array(
data =
c(
43, 29, 134, 23
,26, 22, 149, 36
)
,dim = c(2, 2, 2)
,dimnames = list(
Race = c("W", "B")
,Intercourse = c("Y", "N")
,Gender = c("M", "F")
)
)
sex_ct_flip
sex_data <-
tibble(
Race =
as.factor(
rep(
c("W", "B")
,times =
c(
sum(sex_ct[,,"W"])
,sum(sex_ct[,,"B"])
)
)
)
,Gender =
as.factor(
rep(
rep(c("M", "F"), times = dim(sex_ct)[3])
,times =
c(
sum(sex_ct["M",,"W"])
,sum(sex_ct["F",,"W"])
,sum(sex_ct["M",,"B"])
,sum(sex_ct["F",,"B"])
)
)
)
,Intercourse =
as.numeric(
rep(
rep(c(1, 0), times = dim(sex_ct)[3]*dim(sex_ct)[1])
,times =
c(
sum(sex_ct["M","Y","W"])
,sum(sex_ct["M","N","W"])
,sum(sex_ct["F","Y","W"])
,sum(sex_ct["F","N","W"])
,sum(sex_ct["M","Y","B"])
,sum(sex_ct["M","N","B"])
,sum(sex_ct["F","Y","B"])
,sum(sex_ct["F","N","B"])
)
)
)
)
sex_summary <-
sex_data %>%
group_by(Race, Gender) %>%
summarize(
Yes = sum(Intercourse)
,No = length(Intercourse) - Yes
,Total = Yes + No
)
sex_summary
sex_summary
sex_plot_data <-
sex_summary %>%
ungroup %>%
mutate(
Race = if_else(Race == "W", "White", "Black")
,Gender = if_else(Gender == "M", "Male", "Female")
,Yes = Yes/Total
,No = 1 - Yes
) %>%
select(
-Total
) %>%
gather(
key = Intercourse
,value = `Sample Proportion`
,-Race
,-Gender
)
sex_plot_data
marijuana_plot_data <-
marijuana_summary %>%
ungroup %>%
mutate(
`Alcohol Use` = if_else(Alcohol == "Y", "Yes", "No")
,`Cigarette Use` = if_else(Cigarette == "Y", "Yes", "No")
,Yes = Yes/Total
,No = 1 - Yes
) %>%
select(
-c(
Alcohol
,Cigarette
,Total
)
) %>%
gather(
key = `Marijuana Use`
,value = `Sample Proportion`
,-`Alcohol Use`
,-`Cigarette Use`
)
marijuana_plot_data %>%
ggplot(
aes(
x = `Cigarette Use`
,y = `Sample Proportion`
,fill = `Marijuana Use`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ `Alcohol Use`
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Marijuana Use:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Marijuana Use by Cigarette Use"
,subtitle = "Conditional on Alcohol Use"
)
marijuana_plot_data %>%
ggplot(
aes(
x = `Alcohol Use`
,y = `Sample Proportion`
,fill = `Marijuana Use`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ `Cigarette Use`
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Marijuana Use:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Marijuana Use by Alcohol Use"
,subtitle = "Conditional on Cigarette Use"
)
sex_summary
lung_cancer_plot_data %>%
ggplot(
aes(
x = City
,y = `Sample Proportion`
,fill = `Lung Cancer`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ Smoking
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Has Lung Cancer:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Lung Cancer by City"
,subtitle = "Conditional on whether or not they Smoke"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
lung_cancer_ct <-
array(
data =
c(
126, 35, 100, 61
,908, 497, 688, 807
,913, 336, 747, 598
,235, 58, 172, 121
,402, 121, 308, 215
,182, 72, 156, 98
,60, 11, 99, 43
,104, 21, 89, 36
)
,dim = c(2, 2, 8)
,dimnames = list(
Smoking = c("Y", "N")
,Lung = c("Y", "N")
,City =
c(
"Beij"
,"Shan"
,"Shen"
,"Nanj"
,"Harb"
,"Zhen"
,"Taiy"
,"Nanc"
)
)
)
lung_cancer_ct
lung_cancer_summary <-
lung_cancer_data %>%
group_by(City, Smoking) %>%
summarize(
Yes = sum(Lung)
,No = length(Lung) - Yes
,Total = Yes + No
)
lung_cancer_data <-
tibble(
City =
as.factor(
rep(
c(
"Beij"
,"Shan"
,"Shen"
,"Nanj"
,"Harb"
,"Zhen"
,"Taiy"
,"Nanc"
)
,times =
c(
sum(lung_cancer_ct[,,"Beij"])
,sum(lung_cancer_ct[,,"Shan"])
,sum(lung_cancer_ct[,,"Shen"])
,sum(lung_cancer_ct[,,"Nanj"])
,sum(lung_cancer_ct[,,"Harb"])
,sum(lung_cancer_ct[,,"Zhen"])
,sum(lung_cancer_ct[,,"Taiy"])
,sum(lung_cancer_ct[,,"Nanc"])
)
)
)
,Smoking =
as.factor(
rep(
rep(c("Y", "N"), times = dim(lung_cancer_ct)[3])
,times =
c(
sum(lung_cancer_ct["Y",,"Beij"])
,sum(lung_cancer_ct["N",,"Beij"])
,sum(lung_cancer_ct["Y",,"Shan"])
,sum(lung_cancer_ct["N",,"Shan"])
,sum(lung_cancer_ct["Y",,"Shen"])
,sum(lung_cancer_ct["N",,"Shen"])
,sum(lung_cancer_ct["Y",,"Nanj"])
,sum(lung_cancer_ct["N",,"Nanj"])
,sum(lung_cancer_ct["Y",,"Harb"])
,sum(lung_cancer_ct["N",,"Harb"])
,sum(lung_cancer_ct["Y",,"Zhen"])
,sum(lung_cancer_ct["N",,"Zhen"])
,sum(lung_cancer_ct["Y",,"Taiy"])
,sum(lung_cancer_ct["N",,"Taiy"])
,sum(lung_cancer_ct["Y",,"Nanc"])
,sum(lung_cancer_ct["N",,"Nanc"])
)
)
)
,Lung =
as.numeric(
rep(
rep(c(1, 0), times = dim(lung_cancer_ct)[3]*dim(lung_cancer_ct)[1])
,times =
c(
sum(lung_cancer_ct["Y","Y","Beij"])
,sum(lung_cancer_ct["Y","N","Beij"])
,sum(lung_cancer_ct["N","Y","Beij"])
,sum(lung_cancer_ct["N","N","Beij"])
,sum(lung_cancer_ct["Y","Y","Shan"])
,sum(lung_cancer_ct["Y","N","Shan"])
,sum(lung_cancer_ct["N","Y","Shan"])
,sum(lung_cancer_ct["N","N","Shan"])
,sum(lung_cancer_ct["Y","Y","Shen"])
,sum(lung_cancer_ct["Y","N","Shen"])
,sum(lung_cancer_ct["N","Y","Shen"])
,sum(lung_cancer_ct["N","N","Shen"])
,sum(lung_cancer_ct["Y","Y","Nanj"])
,sum(lung_cancer_ct["Y","N","Nanj"])
,sum(lung_cancer_ct["N","Y","Nanj"])
,sum(lung_cancer_ct["N","N","Nanj"])
,sum(lung_cancer_ct["Y","Y","Harb"])
,sum(lung_cancer_ct["Y","N","Harb"])
,sum(lung_cancer_ct["N","Y","Harb"])
,sum(lung_cancer_ct["N","N","Harb"])
,sum(lung_cancer_ct["Y","Y","Zhen"])
,sum(lung_cancer_ct["Y","N","Zhen"])
,sum(lung_cancer_ct["N","Y","Zhen"])
,sum(lung_cancer_ct["N","N","Zhen"])
,sum(lung_cancer_ct["Y","Y","Taiy"])
,sum(lung_cancer_ct["Y","N","Taiy"])
,sum(lung_cancer_ct["N","Y","Taiy"])
,sum(lung_cancer_ct["N","N","Taiy"])
,sum(lung_cancer_ct["Y","Y","Nanc"])
,sum(lung_cancer_ct["Y","N","Nanc"])
,sum(lung_cancer_ct["N","Y","Nanc"])
,sum(lung_cancer_ct["N","N","Nanc"])
)
)
)
)
lung_cancer_summary <-
lung_cancer_data %>%
group_by(City, Smoking) %>%
summarize(
Yes = sum(Lung)
,No = length(Lung) - Yes
,Total = Yes + No
)
lung_cancer_summary
lung_cancer_plot_data <-
lung_cancer_summary %>%
ungroup %>%
mutate(
Smoking = if_else(Smoking == "Y", "Yes", "No")
,Yes = Yes/Total
,No = 1 - Yes
) %>%
select(
-Total
) %>%
gather(
key = `Lung Cancer`
,value = `Sample Proportion`
,-City
,-Smoking
)
lung_cancer_plot_data %>%
ggplot(
aes(
x = Smoking
,y = `Sample Proportion`
,fill = `Lung Cancer`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ City
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Has Lung Cancer:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Lung Cancer by whether or not they Smoke"
,subtitle = "Conditional on City"
)
lung_cancer_plot_data %>%
ggplot(
aes(
x = City
,y = `Sample Proportion`
,fill = `Lung Cancer`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ Smoking
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Has Lung Cancer:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Lung Cancer by City"
,subtitle = "Conditional on whether or not they Smoke"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
lung_cancer_plot_data %>%
ggplot(
aes(
x = City
,y = `Sample Proportion`
,fill = `Lung Cancer`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ Smoking
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Has Lung Cancer:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Lung Cancer by City"
,subtitle = "Conditional on whether or not they Smoke"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1))
lung_cancer_plot_data %>%
ggplot(
aes(
x = City
,y = `Sample Proportion`
,fill = `Lung Cancer`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ Smoking
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Has Lung Cancer:"
,palette = "Set2"
) +
labs(
title = "Proportion of Persons with Lung Cancer by City"
,subtitle = "Conditional on whether or not they Smoke"
) +
theme(
axis.text.x = element_text(
angle = 45
,hjust = 0.5
,vjust = 0.5
)
)
death_plot_data %>%
ggplot(
aes(
x = Victim
,y = `Sample Proportion`
,fill = `Death Penalty`
)
) +
geom_col(alpha = 0.75) +
facet_wrap(
~ Defendant
,nrow = 1
) +
scale_fill_brewer(
type = "qual"
,name = "Death Penalty:"
,palette = "Set2"
) +
labs(
title = "Proportion of Defendants who Received the Death Penalty by \n Victims's Race"
,subtitle = "Conditional on Defendants's Race"
)
devtools::install_github("EvilGRAHAM/flatr")
library(flatr)
?goodness_of_fit
