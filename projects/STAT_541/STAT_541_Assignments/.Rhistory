knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, warn.conflicts = FALSE, quietly = TRUE)
library(magrittr, warn.conflicts = FALSE, quietly = TRUE)
library(plotly, warn.conflicts = FALSE, quietly = TRUE)
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
theme_minimal2 <- theme_minimal() %>%  theme_set()
theme_minimal2 <-
theme_update(
panel.border = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
,strip.background = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
)
```{r 4.7, include=FALSE}
```{r setup, include=FALSE}
kyphosis <- tibble(
Age = c(
12
,15
,42
,52
,59
,73
,82
,91
,96
,105
,114
,120
,121
,128
,130
,139
,139
,157
,1
,1
,2
,8
,11
,18
,22
,31
,37
,61
,72
,81
,97
,112
,118
,127
,131
,140
,151
,159
,177
,206
)
,Result = c(
rep(1, times = 18)
,rep(0, times = 22)
)
)
logit_reg_kyph <- glm(Result ~ Age, data = kyphosis, family = binomial)
kyphosis %>%
ggplot(
aes(
x = Age
,y = Result
)
) +
geom_point() +
stat_smooth(
method = "glm"
,method.args = list(family = "binomial")
,se = FALSE
) +
labs(y = expression(hat(pi)))
kyphosis %<>%
mutate(Age2 = Age^2)
logit_reg_kyph_poly <- glm(Result ~ Age + Age2, data = kyphosis, family = binomial)
summary(logit_reg_kyph_poly)
prob_kyph_poly_fun <- function(x){
predict(
object = logit_reg_kyph_poly
,newdata = tibble(Age = x, Age2 = x^2)
,type = "response"
)
}
kyphosis %>%
ggplot() +
geom_point(
aes(
x = Age
,y = Result
)
) +
stat_function(
data = tibble(x = c(0, 200))
,aes(x)
,fun = prob_kyph_poly_fun
) +
labs(y = expression(hat(pi))) %>%
ggplotly
kyphosis %>%
ggplot() +
geom_point(
aes(
x = Age
,y = Result
)
) +
stat_function(
data = tibble(x = c(0, 200))
,aes(x)
,fun = prob_kyph_poly_fun
) +
labs(y = expression(hat(pi)))
kyph_poly_plot <-
kyphosis %>%
ggplot() +
geom_point(
aes(
x = Age
,y = Result
)
) +
stat_function(
data = tibble(x = c(0, 200))
,aes(x)
,fun = prob_kyph_poly_fun
) +
labs(y = expression(hat(pi)))
ggplotly(kyph_poly_plot)
devtools::install_github('hadley/ggplot2')
ggplotly(kyph_poly_plot)
kyph_poly_plot <-
kyphosis %>%
ggplot() +
geom_point(
aes(
x = Age
,y = Result
)
) +
stat_function(
data = tibble(x = c(0, 200))
,aes(x)
,fun = prob_kyph_poly_fun
) +
labs(y = expression(hat(pi)))
kyph_poly_plot
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, warn.conflicts = FALSE, quietly = TRUE)
library(tidyverse, warn.conflicts = FALSE, quietly = TRUE)
library(magrittr, warn.conflicts = FALSE, quietly = TRUE)
library(plotly, warn.conflicts = FALSE, quietly = TRUE)
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
theme_minimal2 <- theme_minimal() %>%  theme_set()
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
theme_minimal2 <- theme_minimal() %>%  theme_set()
theme_minimal2 <-
theme_update(
panel.border = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
,strip.background = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
)
kyph_poly_plot
ggplotly(kyph_poly_plot)
