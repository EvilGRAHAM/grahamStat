{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Week 08 Questions\"\nauthor: \"Scott Graham\"\ndate: \"November 3, 2017\"\noutput:\n  html_document:\n    theme: lumen\n    toc: true\n    toc_depth: 2\n    toc_float: true\n    code_folding: hide\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(magrittr, warn.conflicts = FALSE, quietly = TRUE)\ntheme_minimal2 <- theme_minimal() %>%  theme_set()\ntheme_minimal2 <-\n  theme_update(\n    panel.border = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n    ,strip.background = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n  )\n```\n\\[\n  \\newcommand{\\Prob}{\\operatorname{P}}\n  \\newcommand{\\E}{\\operatorname{E}}\n  \\newcommand{\\Var}{\\operatorname{Var}}\n  \\newcommand{\\Cov}{\\operatorname{Cov}}\n  \\newcommand{\\se}{\\operatorname{se}}\n  \\newcommand{\\re}{\\operatorname{re}}\n  \\newcommand{\\ybar}{{\\overline{Y}}}\n  \\newcommand{\\phat}{{\\hat{p}}}\n  \\newcommand{\\that}{{\\hat{T}}}\n  \\newcommand{\\med}{{\\tilde{Y}}}\n\\]\n\n## 4.29\n### Data\n```{r 4.29 Data}\nsex_ct <-\n  array(\n    data =\n      c(\n         43, 26, 134, 149\n        ,29, 22, 23, 36\n      )\n    ,dim = c(2, 2, 2)\n    ,dimnames = list(\n      Gender = c(\"M\", \"F\")\n      ,Intercourse = c(\"Y\", \"N\")\n      ,Race = c(\"W\", \"B\")\n    )\n  )\nsex_ct\n\nsex_ct_flip <-\n  array(\n    data =\n      c(\n         43, 29, 134, 23\n        ,26, 22, 149, 36\n      )\n    ,dim = c(2, 2, 2)\n    ,dimnames = list(\n      Race = c(\"W\", \"B\")\n      ,Intercourse = c(\"Y\", \"N\")\n      ,Gender = c(\"M\", \"F\")\n    )\n  )\nsex_ct_flip\n\nsex_data <- \n  tibble(\n    Race = \n      as.factor(\n        rep(\n          c(\"W\", \"B\")\n        ,times = \n          c(\n            sum(sex_ct[,,\"W\"])\n            ,sum(sex_ct[,,\"B\"])\n          )\n        )\n      )\n    ,Gender =\n      as.factor(\n        rep(\n          rep(c(\"M\", \"F\"), times = dim(sex_ct)[3])\n          ,times =\n            c(\n              sum(sex_ct[\"M\",,\"W\"])\n              ,sum(sex_ct[\"F\",,\"W\"])\n              ,sum(sex_ct[\"M\",,\"B\"])\n              ,sum(sex_ct[\"F\",,\"B\"])\n            )\n        )\n      )\n    ,Intercourse =\n      as.numeric(\n        rep(\n          rep(c(1, 0), times = dim(sex_ct)[3]*dim(sex_ct)[1])\n          ,times =\n            c(\n              sum(sex_ct[\"M\",\"Y\",\"W\"])\n              ,sum(sex_ct[\"M\",\"N\",\"W\"])\n              ,sum(sex_ct[\"F\",\"Y\",\"W\"])\n              ,sum(sex_ct[\"F\",\"N\",\"W\"])\n              ,sum(sex_ct[\"M\",\"Y\",\"B\"])\n              ,sum(sex_ct[\"M\",\"N\",\"B\"])\n              ,sum(sex_ct[\"F\",\"Y\",\"B\"])\n              ,sum(sex_ct[\"F\",\"N\",\"B\"])\n            )\n        )\n      )\n  )\nsex_summary <- \n  sex_data %>% \n  group_by(Race, Gender) %>% \n  summarize(\n    Yes = sum(Intercourse)\n    ,No = length(Intercourse) - Yes\n    ,Total = Yes + No\n  )\nsex_summary\n```\n\n### Cochran-Mantel-Haenszel Test\n$$\n  H_{0}:\\text{ Intercourse is independent of Gender, conditional on Race}\n$$\n$$\n  H_{1}:\\text{ Intercourse is dependent on Gender, conditional on Race}\n$$\n```{r 4.29 CMH}\nsex_cmh <- mantelhaen.test(sex_ct, correct = FALSE)\nsex_cmh\n```\nWith a p-value of `r round(sex_cmh$p.value, 4)`, we reject the null hypothesis, and accept the alternative based on the sample.\n\n$$\n  H_{0}:\\text{ Intercourse is independent of Race, conditional on Gender}\n$$\n$$\n  H_{1}:\\text{ Intercourse is dependent on Race, conditional on Gender}\n$$\n```{r 4.29 CMH Flip}\nsex_cmh_flip <- mantelhaen.test(sex_ct_flip, correct = FALSE)\nsex_cmh_flip\n```\nWith a p-value of `r round(sex_cmh_flip$p.value, 4)`, we reject the null hypothesis, and accept the alternative based on the sample.\n\n### Logistic Regression\n```{r 4.29 Logit}\nlogit_sex_01 <- \n  sex_data %>% \n  glm(\n    Intercourse ~ Race + Gender + Race:Gender\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_sex_01)\n\nlogit_sex_02 <-\n  sex_data %>% \n  glm(\n    Intercourse ~ Race + Gender\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_sex_02)\n\nanova(logit_sex_02, logit_sex_01, test = \"Chisq\")\n```\nBy doing a Likielihood Ratio Test between the model with an interaction term, and the model without, a p-value of `r round(anova(logit_sex_02, logit_sex_01, test = \"Chisq\")$\"Pr(>Chi)\"[2], 4)` is found. This fails to reject the null hypothesis of explaining equal amounts of variance, based on the sample. As such we can use the more parsimonious model.\n\nBoth the slope parameters are significant at $\\alpha=0.05$, based on the sample. A White person on average has an increased log likelihood in favour of having intercourse of `r round(coefficients(logit_sex_02)[2], 4)` vs. a Black person, based on the sample. A Male on average has an increased log likelihood in favour of having intercourse of `r round(coefficients(logit_sex_02)[3], 4)` vs. a Female, based on the sample.\n\n\n## 4.31\n### Data\n```{r 4.31 Data}\nmarijuana_ct <-\n  array(\n    data =\n      c(\n         911, 44, 538, 456\n        ,3, 2, 43, 279\n      )\n    ,dim = c(2, 2, 2)\n    ,dimnames = list(\n      Cigarette = c(\"Y\", \"N\")\n      ,Marijuana = c(\"Y\", \"N\")\n      ,Alcohol = c(\"Y\", \"N\")\n    )\n  )\nmarijuana_ct\n\nmarijuana_ct_flip <-\n  array(\n    data =\n      c(\n         911, 3, 538, 43\n        ,44, 2, 456, 279\n      )\n    ,dim = c(2, 2, 2)\n    ,dimnames = list(\n      Alcohol = c(\"Y\", \"N\")\n      ,Marijuana = c(\"Y\", \"N\")\n      ,Cigarette = c(\"Y\", \"N\")\n    )\n  )\nmarijuana_ct_flip\n\nmarijuana_data <- \n  tibble(\n    Alcohol = \n      as.factor(\n        rep(\n          c(\"Y\", \"N\")\n        ,times = \n          c(\n            sum(marijuana_ct[,,\"Y\"])\n            ,sum(marijuana_ct[,,\"N\"])\n          )\n        )\n      )\n    ,Cigarette =\n      as.factor(\n        rep(\n          rep(c(\"Y\", \"N\"), times = dim(marijuana_ct)[3])\n          ,times =\n            c(\n              sum(marijuana_ct[\"Y\",,\"Y\"])\n              ,sum(marijuana_ct[\"N\",,\"Y\"])\n              ,sum(marijuana_ct[\"Y\",,\"N\"])\n              ,sum(marijuana_ct[\"N\",,\"N\"])\n            )\n        )\n      )\n    ,Marijuana =\n      as.numeric(\n        rep(\n          rep(c(1, 0), times = dim(marijuana_ct)[3]*dim(marijuana_ct)[1])\n          ,times =\n            c(\n              sum(marijuana_ct[\"Y\",\"Y\",\"Y\"])\n              ,sum(marijuana_ct[\"Y\",\"N\",\"Y\"])\n              ,sum(marijuana_ct[\"N\",\"Y\",\"Y\"])\n              ,sum(marijuana_ct[\"N\",\"N\",\"Y\"])\n              ,sum(marijuana_ct[\"Y\",\"Y\",\"N\"])\n              ,sum(marijuana_ct[\"Y\",\"N\",\"N\"])\n              ,sum(marijuana_ct[\"N\",\"Y\",\"N\"])\n              ,sum(marijuana_ct[\"N\",\"N\",\"N\"])\n            )\n        )\n      )\n  )\nmarijuana_summary <- \n  marijuana_data %>% \n  group_by(Alcohol, Cigarette) %>% \n  summarize(\n    Yes = sum(Marijuana)\n    ,No = length(Marijuana) - Yes\n    ,Total = Yes + No\n  )\nmarijuana_summary\n```\n\n### Cochran-Mantel-Haenszel Test\n$$\n  H_{0}:\\text{ Marijuana Use is independent of Cigarette Use, conditional on Alcohol Use}\n$$\n$$\n  H_{1}:\\text{ Marijuana Use is dependent on Cigarette Use, conditional on Alcohol Use}\n$$\n```{r 4.31 CMH}\nmarijuana_cmh <- mantelhaen.test(marijuana_ct, correct = FALSE)\nmarijuana_cmh\n```\nWith a p-value of `r round(marijuana_cmh$p.value, 4)`, we reject the null hypothesis, and accept the alternative based on the sample.\n\n$$\n  H_{0}:\\text{ Marijuana Use is independent of Alcohol Use, conditional on Cigarette Use}\n$$\n$$\n  H_{1}:\\text{ Marijuana Use is dependent on Alcohol Use, conditional on Cigarette Use}\n$$\n```{r 4.31 CMH Flip}\nmarijuana_cmh_flip <- mantelhaen.test(marijuana_ct_flip, correct = FALSE)\nmarijuana_cmh_flip\n```\nWith a p-value of `r round(marijuana_cmh_flip$p.value, 4)`, we reject the null hypothesis, and accept the alternative based on the sample.\n\n### Logistic Regression\n```{r 4.31 Logit}\nlogit_marijuana_01 <- \n  marijuana_data %>% \n  glm(\n    Marijuana ~ Alcohol + Cigarette + Alcohol:Cigarette\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_marijuana_01)\n\nlogit_marijuana_02 <-\n  marijuana_data %>% \n  glm(\n    Marijuana ~ Alcohol + Cigarette\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_marijuana_02)\n\nanova(logit_marijuana_02, logit_marijuana_01, test = \"Chisq\")\n```\nBy doing a Likielihood Ratio Test between the model with an interaction term, and the model without, a p-value of `r round(anova(logit_marijuana_02, logit_marijuana_01, test = \"Chisq\")$\"Pr(>Chi)\"[2], 4)` is found. This fails to reject the null hypothesis of explaining equal amounts of variance, based on the sample. As such we can use the more parsimonious model.\n\nBoth the slope parameters are significant at $\\alpha=0.05$, based on the sample. A person with Alcohol Use on average has an increased log likelihood in favour of Marijuana Use of `r round(coefficients(logit_marijuana_02)[2], 4)` vs. a person without, based on the sample. A person with Cigarette Use on average has an increased log likelihood in favour of Marijuana Use of `r round(coefficients(logit_marijuana_02)[3], 4)` vs. a person without, based on the sample.\n\n\n## 5.17\n```{r 5.17}\ndeath_ct <- \n  array(\n    data =\n      c(\n         53, 11, 414, 37\n        ,0, 4, 16, 139\n      )\n    ,dim = c(2, 2, 2)\n    ,dimnames = list(\n      Defendant = c(\"W\", \"B\")\n      ,Death = c(\"Y\", \"N\")\n      ,Victim = c(\"W\", \"B\")\n    )\n  )\ndeath_ct\n\ndeath_data <- \n  tibble(\n    Victim = \n      as.factor(\n        rep(\n          c(\"W\", \"B\")\n        ,times = \n          c(\n            sum(death_ct[,,\"W\"])\n            ,sum(death_ct[,,\"B\"])\n          )\n        )\n      )\n    ,Defendant =\n      as.factor(\n        rep(\n          rep(c(\"W\", \"B\"), times = dim(death_ct)[3])\n          ,times =\n            c(\n              sum(death_ct[\"W\",,\"W\"])\n              ,sum(death_ct[\"B\",,\"W\"])\n              ,sum(death_ct[\"W\",,\"B\"])\n              ,sum(death_ct[\"B\",,\"B\"])\n            )\n        )\n      )\n    ,Death =\n      as.numeric(\n        rep(\n          rep(c(1, 0), times = dim(death_ct)[3]*dim(death_ct)[1])\n          ,times =\n            c(\n              sum(death_ct[\"W\",\"Y\",\"W\"])\n              ,sum(death_ct[\"W\",\"N\",\"W\"])\n              ,sum(death_ct[\"B\",\"Y\",\"W\"])\n              ,sum(death_ct[\"B\",\"N\",\"W\"])\n              ,sum(death_ct[\"W\",\"Y\",\"B\"])\n              ,sum(death_ct[\"W\",\"N\",\"B\"])\n              ,sum(death_ct[\"B\",\"Y\",\"B\"])\n              ,sum(death_ct[\"B\",\"N\",\"B\"])\n            )\n        )\n      )\n  )\ndeath_summary <- \n  death_data %>% \n  group_by(Victim, Defendant) %>% \n  summarize(\n    Yes = sum(Death)\n    ,No = length(Death) - Yes\n    ,Total = Yes + No\n  )\ndeath_summary\n```\n### a.\n```{r 5.17a}\nlogit_death <- \n  death_data %>% \n  glm(\n    Death ~ Victim + Defendant\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_death)\n\ndeath_summary %<>% \n  cbind(\n    phat = \n      predict(\n        object = logit_death\n        ,newdata = death_summary %>% dplyr::select(Victim, Defendant)\n        ,type = \"response\"\n      ) %>% t\n  ) %>% \n  mutate(\n    Expected_Yes = Total*phat\n    ,Expected_No = Total*(1-phat)\n  )\ndeath_summary\n\ndeath_chisq_stat <-\n  death_summary %>% \n  ungroup %>% \n  mutate(\n    ChiSq_Yes = (Yes - Expected_Yes)^(2) / Expected_Yes\n    ,ChiSq_No = (No - Expected_No)^(2) / Expected_No\n  ) %>% \n  dplyr::select(\n    ChiSq_Yes\n    ,ChiSq_No\n  ) %>% \n  sum\ndeath_chisq_stat\ndeath_chisq_p_value <- \n  pchisq(\n    q = death_chisq_stat\n    ,df = prod(dim(death_ct)-1)\n    ,lower.tail = FALSE\n  )\ndeath_chisq_p_value\n```\nBased on the sample, and the logistic regression found above, doing a $\\chi^{2}$ Goodness of Fit Test yields a p-value of `r round(death_chisq_p_value, 4)`. Therefore we fail to reject the null hypothesis that the model fits the data and assume it to be true. A $G^{2}$ Goodness of Fit Test can't be used as no White Defendants with Black Victims were given the death penalty.\n\n### c.\nBoth the slope parameters are significant at $\\alpha=0.05$, based on the sample. A Defendant with a White Victim on average has an increased log likelihood in favour of getting the death penalty of `r round(coefficients(logit_death)[2], 4)` vs. a Black Victim, based on the sample. A White Defendant on average has an increased log likelihood in favour of getting the death penalty of `r round(coefficients(logit_death)[3], 4)` vs. a Black Defendant, based on the sample.\n\n\n## 5.18\n```{r 5.18}\nlung_cancer_ct <- \n  array(\n    data =\n      c(\n         126, 35, 100, 61\n        ,908, 497, 688, 807\n        ,913, 336, 747, 598\n        ,235, 58, 172, 121\n        ,402, 121, 308, 215\n        ,182, 72, 156, 98\n        ,60, 11, 99, 43\n        ,104, 21, 89, 36\n      )\n    ,dim = c(2, 2, 8)\n    ,dimnames = list(\n      Smoking = c(\"Y\", \"N\")\n      ,Lung = c(\"Y\", \"N\")\n      ,City = \n        c(\n          \"Beij\"\n          ,\"Shan\"\n          ,\"Shen\"\n          ,\"Nanj\"\n          ,\"Harb\"\n          ,\"Zhen\"\n          ,\"Taiy\"\n          ,\"Nanc\"\n        )\n    )\n  )\nlung_cancer_ct\n\nlung_cancer_data <- \n  tibble(\n    City = \n      as.factor(\n        rep(\n          c(\n            \"Beij\"\n            ,\"Shan\"\n            ,\"Shen\"\n            ,\"Nanj\"\n            ,\"Harb\"\n            ,\"Zhen\"\n            ,\"Taiy\"\n            ,\"Nanc\"\n          )\n        ,times = \n          c(\n            sum(lung_cancer_ct[,,\"Beij\"])\n            ,sum(lung_cancer_ct[,,\"Shan\"])\n            ,sum(lung_cancer_ct[,,\"Shen\"])\n            ,sum(lung_cancer_ct[,,\"Nanj\"])\n            ,sum(lung_cancer_ct[,,\"Harb\"])\n            ,sum(lung_cancer_ct[,,\"Zhen\"])\n            ,sum(lung_cancer_ct[,,\"Taiy\"])\n            ,sum(lung_cancer_ct[,,\"Nanc\"])\n          )\n        )\n      )\n    ,Smoking =\n      as.factor(\n        rep(\n          rep(c(\"Y\", \"N\"), times = dim(lung_cancer_ct)[3])\n          ,times =\n            c(\n              sum(lung_cancer_ct[\"Y\",,\"Beij\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Beij\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Shan\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Shan\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Shen\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Shen\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Nanj\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Nanj\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Harb\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Harb\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Zhen\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Zhen\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Taiy\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Taiy\"])\n              ,sum(lung_cancer_ct[\"Y\",,\"Nanc\"])\n              ,sum(lung_cancer_ct[\"N\",,\"Nanc\"])\n            )\n        )\n      )\n    ,Lung =\n      as.numeric(\n        rep(\n          rep(c(1, 0), times = dim(lung_cancer_ct)[3]*dim(lung_cancer_ct)[1])\n          ,times =\n            c(\n              sum(lung_cancer_ct[\"Y\",\"Y\",\"Beij\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Beij\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Beij\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Beij\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Shan\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Shan\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Shan\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Shan\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Shen\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Shen\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Shen\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Shen\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Nanj\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Nanj\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Nanj\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Nanj\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Harb\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Harb\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Harb\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Harb\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Zhen\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Zhen\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Zhen\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Zhen\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Taiy\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Taiy\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Taiy\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Taiy\"])\n              ,sum(lung_cancer_ct[\"Y\",\"Y\",\"Nanc\"])\n              ,sum(lung_cancer_ct[\"Y\",\"N\",\"Nanc\"])\n              ,sum(lung_cancer_ct[\"N\",\"Y\",\"Nanc\"])\n              ,sum(lung_cancer_ct[\"N\",\"N\",\"Nanc\"])\n            )\n        )\n      )\n  )\nlung_cancer_summary <- \n  lung_cancer_data %>% \n  group_by(City, Smoking) %>% \n  summarize(\n    Yes = sum(Lung)\n    ,No = length(Lung) - Yes\n    ,Total = Yes + No\n  )\nlung_cancer_summary\n```\n### a.\n```{r 5.18a}\nlogit_lung_cancer <- \n  lung_cancer_data %>% \n  glm(\n    Lung ~ City + Smoking\n    ,family = binomial\n    ,data = .\n  )\nsummary(logit_lung_cancer)\n```\nA Smoker on average has an increased log likelihood in favour of getting Lung Cancer of `r round(coefficients(logit_lung_cancer)[9], 4)` vs. a non-smoker, based on the sample.\n\n### b.\n```{r 5.18b}\nlung_cancer_summary %<>% \n  cbind(\n    phat = \n      predict(\n        object = logit_lung_cancer\n        ,newdata = lung_cancer_summary %>% dplyr::select(City, Smoking)\n        ,type = \"response\"\n      ) %>% t\n  ) %>% \n  mutate(\n    Expected_Yes = Total*phat\n    ,Expected_No = Total*(1-phat)\n  )\nlung_cancer_summary\n\nlung_cancer_chisq_stat <-\n  lung_cancer_summary %>% \n  ungroup %>% \n  mutate(\n    ChiSq_Yes = (Yes - Expected_Yes)^(2) / Expected_Yes\n    ,ChiSq_No = (No - Expected_No)^(2) / Expected_No\n  ) %>% \n  dplyr::select(\n    ChiSq_Yes\n    ,ChiSq_No\n  ) %>% \n  sum\nlung_cancer_chisq_stat\nlung_cancer_chisq_p_value <- \n  pchisq(\n    q = lung_cancer_chisq_stat\n    ,df = prod(dim(lung_cancer_ct)-1)\n    ,lower.tail = FALSE\n  )\nlung_cancer_chisq_p_value\n\nlung_cancer_gsq_stat <-\n  lung_cancer_summary %>% \n  ungroup %>% \n  mutate(\n    Gsq_Yes = 2*Yes*log(Yes/Expected_Yes)\n    ,Gsq_No = 2*No*log(No/Expected_No)\n  ) %>% \n  dplyr::select(\n    Gsq_Yes\n    ,Gsq_No\n  ) %>% \n  sum\nlung_cancer_gsq_stat\nlung_cancer_gsq_p_value <-\n  pchisq(\n    q = lung_cancer_gsq_stat\n    ,df = prod(dim(lung_cancer_ct)-1)\n    ,lower.tail = FALSE\n  )\nlung_cancer_gsq_p_value\n```\nBased on the sample, and the logistic regression found above, doing a $\\chi^{2}$ Goodness of Fit Test yields a p-value of `r round(lung_cancer_chisq_p_value, 4)`. Therefore we fail to reject the null hypothesis that the model fits the data and assume it to be true.\n\nBased on the sample, and the logistic regression found above, doing a $G^{2}$ Goodness of Fit Test yields a p-value of `r round(lung_cancer_gsq_p_value, 4)`. Therefore we fail to reject the null hypothesis that the model fits the data and assume it to be true.",
    "created" : 1509654556145.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2082139681",
    "id" : "7A5F7FA8",
    "lastKnownWriteTime" : 1509654513,
    "last_content_update" : 1509654513,
    "path" : "~/GitHub/grahamStat/projects/STAT_541/STAT_541_Assignments/Week_08_Questions.Rmd",
    "project_path" : "Week_08_Questions.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}