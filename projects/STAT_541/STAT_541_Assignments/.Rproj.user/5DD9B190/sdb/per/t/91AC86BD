{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Week 05 Questions\"\nauthor: \"Scott Graham\"\ndate: \"October 13, 2017\"\noutput:\n  html_document:\n    theme: lumen\n    toc: true\n    toc_depth: 2\n    toc_float: true\n    code_folding: hide\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(magrittr, warn.conflicts = FALSE, quietly = TRUE)\ntheme_minimal2 <- theme_minimal() %>%  theme_set()\ntheme_minimal2 <-\n  theme_update(\n    panel.border = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n    ,strip.background = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n  )\n```\n\\[\n  \\newcommand{\\Prob}{\\operatorname{P}}\n  \\newcommand{\\E}{\\operatorname{E}}\n  \\newcommand{\\Var}{\\operatorname{Var}}\n  \\newcommand{\\Cov}{\\operatorname{Cov}}\n  \\newcommand{\\se}{\\operatorname{se}}\n  \\newcommand{\\re}{\\operatorname{re}}\n  \\newcommand{\\ybar}{{\\overline{Y}}}\n  \\newcommand{\\phat}{{\\hat{p}}}\n  \\newcommand{\\that}{{\\hat{T}}}\n  \\newcommand{\\med}{{\\tilde{Y}}}\n\\]\n\n## 4.09\n```{r 4.09}\ncrabs_data <- \n  read_csv(\n    file = \"http://grahamst.at/projects/STAT_541/STAT_541_Assignments/Week_05_Data_4.09.csv\"\n  ) %>% \n  mutate(\n    satell_bool = if_else(satell > 0, 1, 0)\n    ,c1 = if_else(color == 1, 1, 0 )\n    ,c2 = if_else(color == 2, 1, 0 )\n    ,c3 = if_else(color == 3, 1, 0 )\n    ,color = color + 1\n  )\n```\n### a.\n```{r 4.09a}\nlogit_reg_4.09a <- glm(satell_bool ~ c1 + c2 + c3, data = crabs_data, family = \"binomial\")\nsummary(logit_reg_4.09a)\n```\n$$\n  \\ln\\left( \\theta \\right) =\n  -0.7621 + 1.8608c_{1} + 1.7382c_{2} + 1.1299c_{3}\n$$\nThat is, on average for a medium light crab, the log odds in favour increase by 1.8608 compared to a dark crab, based on the sample. Or the average odds in favour increase by a multiplicative factor of $e^{1.8608} = 6.4286$, based on the sample.\n\n### b.\n```{r 4.09b}\npchisq(\n  q = logit_reg_4.09a$null.deviance - logit_reg_4.09a$deviance\n  ,df = logit_reg_4.09a$df.null - logit_reg_4.09a$df.residual\n  ,lower.tail = FALSE\n)\n```\nWe therefore reject our null hypothesis that the models have similar levels of deviance, and accept the alternative that they differ, based on the sample. That is, colour does play a role in predicting if a crab has satellites.\n\n### c.\n```{r 4.09c}\nlogit_reg_4.09c <- glm(satell_bool ~ color, data = crabs_data, family = \"binomial\")\nsummary(logit_reg_4.09c)\n```\n$$\n  \\ln\\left( \\theta \\right) =\n  3.0781 - 0.7147Colour\n$$\nAs you move each step up the colour scale, with 2 being medium light, and 5 being dark, on average the log odds in favour decrease by 0.7147, or the odds decrease by a multiplicative factor of $e^{-0.7147} = 0.4893$, based on the sample.\n\n### d.\n```{r 4.09d}\npchisq(\n  q = logit_reg_4.09c$null.deviance - logit_reg_4.09c$deviance\n  ,df = logit_reg_4.09c$df.null - logit_reg_4.09c$df.residual\n  ,lower.tail = FALSE\n)\n```\nTherefore we reject the null hypothesis that the models explain the same amount of variance, and accept that the more complicated model is better based on the sample.\n\n### e.\nThe advantage of quantitative colour, is we set the $df$ in the likelihood ratio test to 1, giving a more powerful test, but if there is a non-linear relationship between colour and the log odds in favour (polynomial, exponential, etc), this model may not capture it.\n\n\n## 4.11\n$$\n  \\frac{\\theta_{\\text{Spouse}}}{\\theta_{\\text{Alone}}} =\n  2.02,\n  \\frac{\\theta_{\\text{Others}}}{\\theta_{\\text{Alone}}} =\n  1.71 \\implies\n  \\frac{\\theta_{\\text{Spouse}}}{\\theta_{\\text{Others}}} =\n  \\frac{2.02}{1.71} =\n  1.18\n$$\n$$\n  \\frac{\\theta_{\\text{Medium Income}}}{\\theta_{\\text{Low Income}}} =\n  0.72,\n  \\frac{\\theta_{\\text{High Income}}}{\\theta_{\\text{Low Income}}} =\n  0.41 \\implies\n  \\frac{\\theta_{\\text{High Income}}}{\\theta_{\\text{Medium Income}}} =\n  \\frac{0.41}{0.72} =\n  0.57\n$$\n\n\n## 4.16\n```{r 4.16}\nmyers_data <- \n  tibble(\n    Personality = c(\n      rep(\"ESTJ\", times = 10 + 67)\n      ,rep(\"ESTP\", times = 8 + 34)\n      ,rep(\"ESFJ\", times = 5 + 101)\n      ,rep(\"ESFP\", times = 7 + 72)\n      ,rep(\"ENTJ\", times = 3 + 20)\n      ,rep(\"ENTP\", times = 2 + 16)\n      ,rep(\"ENFJ\", times = 4 + 27)\n      ,rep(\"ENFP\", times = 15 + 65)\n      ,rep(\"ISTJ\", times = 17 + 123)\n      ,rep(\"ISTP\", times = 3 + 49)\n      ,rep(\"ISFJ\", times = 6 + 132)\n      ,rep(\"ISFP\", times = 4 + 102)\n      ,rep(\"INTJ\", times = 1 + 12)\n      ,rep(\"INTP\", times = 5 + 30)\n      ,rep(\"INFJ\", times = 1 + 30)\n      ,rep(\"INFP\", times = 6 + 73)\n    )\n    ,Alcohol = c(\n      rep(c(1, 0), times = c(10, 67))\n      ,rep(c(1, 0), times = c(8, 34))\n      ,rep(c(1, 0), times = c(5, 101))\n      ,rep(c(1, 0), times = c(7, 72))\n      ,rep(c(1, 0), times = c(3, 20))\n      ,rep(c(1, 0), times = c(2, 16))\n      ,rep(c(1, 0), times = c(4, 27))\n      ,rep(c(1, 0), times = c(15, 65))\n      ,rep(c(1, 0), times = c(17, 123))\n      ,rep(c(1, 0), times = c(3, 49))\n      ,rep(c(1, 0), times = c(6, 132))\n      ,rep(c(1, 0), times = c(4, 102))\n      ,rep(c(1, 0), times = c(1, 12))\n      ,rep(c(1, 0), times = c(5, 30))\n      ,rep(c(1, 0), times = c(1, 30))\n      ,rep(c(1, 0), times = c(6, 73))\n    )\n  ) %>% \n  # If the stated letter appears in the personality column, place a 1, \n  # otherwise place a 0.\n  mutate(\n    `E/I` = if_else(grepl(pattern = \"E\", x = Personality), 1, 0)\n    ,`S/N` = if_else(grepl(pattern = \"S\", x = Personality), 1, 0)\n    ,`T/F` = if_else(grepl(pattern = \"T\", x = Personality), 1, 0)\n    ,`J/P` = if_else(grepl(pattern = \"J\", x = Personality), 1, 0)\n  )\nmyers_data\n```\n### a.\n```{r 4.16a}\nlogit_reg_4.16a <- glm(\n  Alcohol ~ `E/I` + `S/N` + `T/F` + `J/P`\n  ,data = myers_data\n  ,family = \"binomial\"\n)\nsummary(logit_reg_4.16a)\n```\n$$\n  \\ln\\left( \\theta \\right) =\n  -2.4668 + 0.5550\\text{E/I} - 0.4292\\text{S/N} + 0.6873\\text{T/F} - 0.2022\\text{J/P}\n$$\nWhere the first letter for each coefficient is coded as a 1, and the second letter as a 0.\n\n### b.\n```{r 4.16b}\npredict(\n  object = logit_reg_4.16a\n  ,newdata = \n    tibble(\n    `E/I` = 1\n    ,`S/N` = 1\n    ,`T/F` = 1\n    ,`J/P` = 1\n  )\n  ,type = \"response\")\n```\n\n### c.\n```{r 4.16c}\npredict(\n  object = logit_reg_4.16a\n  ,newdata = \n    tibble(\n    `E/I` = 1\n    ,`S/N` = 0\n    ,`T/F` = 1\n    ,`J/P` = 0\n  )\n  ,type = \"response\")\n```\nIt is the response that has all the positive coefficients set to 1, and the negative coefficients set to 0.\n\n\n## 4.17\n### a.\n```{r 4.17a}\nlogit_reg_4.17a <- glm(\n  Alcohol ~ `E/I` + `T/F`\n  ,data = myers_data\n  ,family = \"binomial\"\n)\nsummary(logit_reg_4.17a)\npredict(\n  object = logit_reg_4.17a\n  ,newdata = \n    tibble(\n    `E/I` = 0\n    ,`T/F` = 0\n  )\n  ,type = \"response\")\n```\n\n### b.\n$$\n  e^{\\beta_{\\text{E/I}}} =\n  e^{0.5805} =\n  1.7869\n$$\nThe odds in favour on average increases by a mulitplicative factor 1.7869 for extroverted personalities vs. introverted personalities, based on the sample.\n\n### c.\n```{r 4.17c}\nconfint(object = logit_reg_4.17a, level = 0.95) %>% \n  exp %>% \n  round(4)\n```\nWith 95\\% confidence, the true value of the conditional odds ratio between E/I and the response lies between 1.1722 and 2.7400 based on the sample.\n\n### d.\n$$\n  \\beta_{\\text{I/E}} =\n  -\\beta_{\\text{E/I}} =\n  -0.5805 \\implies\n  e^{\\beta_{\\text{I/E}}} =\n  \\frac{1}{e^{\\beta_{\\text{E/I}}}} =\n  e^{-0.5805} =\n  0.5596\n$$\n95\\% CI for the conditional odds ratio between I/E and the response:\n$$\n  \\left[\\frac{1}{2.7400}, \\frac{1}{1.1722} \\right] =\n  [0.3650, 0.8531]\n$$\nWith 95\\% confidence, the true value of the conditional odds ratio between I/E and the response lies between 0.3650 and 0.8531 based on the sample.\n\n### e.\n```{r 4.17e}\nlogit_reg_4.17e <- glm(\n  Alcohol ~ `T/F`\n  ,data = myers_data\n  ,family = \"binomial\"\n)\nsummary(logit_reg_4.17e)\nanova(logit_reg_4.17e, logit_reg_4.17a, test = \"Chisq\")\n```\nUsing the likelihood ratio test, comparing the two models, a p-value of 0.006955 is observed. So at $\\alpha=0.05$ the null hypothesis of equivalent explained variance is rejected, and it can be assumed that E/I plays a statistically significant effect based on the sample.\n\n\n## 4.19\n```{r 4.19}\nlogit_reg_4.19 <- function(Gender, Religion, Political){\n  log_odds <-\n    -0.11 + \n    if_else(Gender == \"M\", 0.0, 0.16) +\n    if_else(Religion == \"J\", 0.0, if_else(Religion == \"C\", -0.66, -0.57)) +\n    if_else(Political == \"I\", 0.0, if_else(Political == \"R\", -1.67, 0.84))\n  log_odds\n}\n```\n### a.\n$$\n  OR_{\\text{Gender}} =\n  e^{\\hat{\\beta}_{1}^{G} - \\hat{\\beta}_{2}^{G}} =\n  e^{0.16 - 0} = \n  1.1735\n$$\nHolding all else equal, the odds of supporting legalized abortion increases on average by a multiplicative factor of 1.1735 for females vs. males.\n\n### b.\n```{r 4.19b}\nlog_odds_MCR <- logit_reg_4.19(Gender = \"M\", Religion = \"C\", Political = \"R\")\nprob_MCR <- exp(log_odds_MCR)/(1 + exp(log_odds_MCR))\nprob_MCR\nlog_odds_FJD <- logit_reg_4.19(Gender = \"F\", Religion = \"J\", Political = \"D\")\nprob_FJD <- exp(log_odds_FJD)/(1 + exp(log_odds_FJD))\nprob_FJD\n```\n\n### c.\n$$\n  \\hat{\\beta}_{2}^{G} = \n  0.16 \\implies\n  OR_{\\text{Gender}} =\n  e^{\\hat{\\beta}_{1}^{G} - \\hat{\\beta}_{2}^{G}} =\n  e^{0 - 0.16} =\n  0.8521\n$$\nHolding all else equal, the odds of supporting legalized abortion decreases on average by a multiplicative factor of 0.8521 for males vs. females.\n\n### d.\n$$\n  \\hat{\\beta}_{1}^{G} + \\hat{\\beta}_{2}^{G} =\n  0,\n  \\hat{\\beta}_{1}^{G} - \\hat{\\beta}_{2}^{G} =\n  0.16 \\implies\n  \\hat{\\beta}_{1}^{G} =\n  0.08, \n  \\hat{\\beta}_{2}^{G} =\n  -0.08 \\implies\n$$\n$$\n  OR_{\\text{Gender}} =\n  e^{0.08-(-0.08)} =\n  e^{0.16} =\n  1.1735\n$$\n\n\n## 4.21\n### a.\nThe odds in favour of getting condoms increases on average by a multiplicative factor of 4.04 for those who wached the video, vs. those who didn't based on the sample. With 95\\% confidence the true value of said odds ratio is between 1.17 and 13.9.\n\n### b.\n$$\n  \\ln\\left( \\theta_{\\text{Condoms}} \\right) =\n  \\hat{\\beta_{0}} + \\ln 4.04x_{\\text{Group}} + \\ln 1.38x_{\\text{Gender}} + \\ln 5.82x_{\\text{SES}} + \\ln 3.22x_{\\text{Num. of Partners}} \\implies\n$$\n$$\n  \\ln\\left( \\theta_{\\text{Condoms}} \\right) =\n  \\hat{\\beta_{0}} + 1.40x_{\\text{Group}} + 0.32x_{\\text{Gender}} + 1.76x_{\\text{SES}} + 1.17x_{\\text{Num. of Partners}}\n$$\n\n### c.\n$$\n  \\hat{\\beta}_{\\text{Gender}} =\n  \\frac{\\ln 1.23 + \\ln 12.88}{2} =\n  1.3813 \\approx\n  1.38 \\neq\n  \\ln 1.38 =\n  0.3221 \\implies \n$$\n$$\n  OR_{\\text{Gender}} =\n  e^{1.38} =\n  3.9803 \\approx\n  3.98\n$$\nTherefore, if the confidence interval is correct the log odds ratio for gender must be 1.38, giving an estimated odds ratio of 3.98.",
    "created" : 1509064708793.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4097446338",
    "id" : "91AC86BD",
    "lastKnownWriteTime" : 1508527855,
    "last_content_update" : 1508527855,
    "path" : "~/GitHub/grahamStat/projects/STAT_541/STAT_541_Assignments/Week_05_Questions.Rmd",
    "project_path" : "Week_05_Questions.Rmd",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}